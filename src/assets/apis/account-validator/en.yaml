openapi: 3.1.0
info:
  title: PlacetoPay Account Validator
  version: '1.0'
  description: |
    Account Validator is a project responsible for account verification through external services.
  contact:
    url: 'https://www.evertecinc.com/pasarela-de-pagos-e-commerce/'
    name: PlacetoPay by Evertec
servers:
  - description: 'Sandbox (CO)'
    url: 'https://sites-test.placetopay.com/'
paths:
  /api/create-session:
    post:
      summary: "Create Session"
      description: "This endpoint allows you to create an account verification session."
      operationId: "create-session"
      requestBody:
        description: ""
        content:
          application/json:
            schema:
              type: object
              required:
                - auth
                - user
                - returnUrl
                - locale
              properties:
                auth:
                  type: object
                  description: Structure containing the site's authentication information generated according to the WSSE UsernameToken Profile 1.1.
                  required:
                    - login
                    - tranKey
                    - nonce
                    - seed
                  properties:
                    login:
                      type: string
                    tranKey:
                      type: string
                    nonce:
                      type: string
                    seed:
                      type: string
                user:
                  type: object
                  description: |
                    User who owns the account to be validated
                  required:
                    - name
                    - email
                  properties:
                    name:
                      type: string
                      description: |
                        First name(s) of the account owner
                        
                        `>= 1 characters` `<= 50 characters`
                        
                        EX: `John`
                    surname:
                      type: string
                      description: |
                        Last name(s) of the account owner
                        
                        `<= 50 characters`

                        EX: `Doe`
                    email:
                      type: email
                      description: |
                        Email address of the account owner
                        
                        `<= 80 characters`

                        EX: `John.doe@test.com`
                returnUrl:
                  type: string
                  description: |
                    Return URL once the account validation process is completed
                    
                    `<= 255 characters`
                    
                    EX: `https://www.placetopay.com/return`
                locale:
                  type: string
                  description: |
                    Determines the response language
                    
                    `<= 5 characters`
                    
                    EX: `es_CO`
                isAuthenticated:
                  type: boolean
                  description: |
                    Indicates if an external authentication process has already been performed. The intention is not to validate the user's email twice. Default is false, meaning an OTP will be sent to validate the user if they have already validated accounts with micro-deposits in the system.
                    
                    EX: `false`
      responses:
        "200":
          description: "Session created successfully"
          content:
            application/json:
              schema:
                type: object
                properties:
                  data:
                    type: object
                    description: Structure containing the response to the request if the status is successful
                    properties:
                      requestId:
                        type: string
                        description: |
                          Unique identifier of the session to be queried.
                          
                          `<= 36 characters`
                          
                          EX: `9bd89c8d-6097-4d69-8ce9-d9b5ec35d8ea`
                          
                          Match pattern:
                          `[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}`
                      redirectUrl:
                        type: string <url>
                        description: |
                          Response code
                          
                          EX: `https://dev-account-validator.placetopay.ws/verification/redirect/9bd89c8d-6097-4d69-8ce9-d9b5ec35d8ea`
                      expiresAt:
                        type: string
                        description: |
                          Session expiration date
                          
                          EX: `2024-04-19 17:36:57`
                  status:
                    type: object
                    description: Structure containing information about the request status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status
                          
                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code
                          
                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time
                          
                           EX: `2021-09-21T09:34:48-05:00`
                    required:
                      - status
                      - reason
                      - message
                      - date
        "400":
          description: |
            Invalid request.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Structure containing information about the request status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status
                          
                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code
                          
                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time
                          
                           EX: `2021-09-21T09:34:48-05:00`
                    required:
                      - status
                      - reason
                      - message
                      - date
                required:
                  - Status
  /api/check-session-status:
    post:
      summary: "Check Session Status"
      description: "This endpoint allows you to check the status of a created session."
      operationId: check-session-status
      requestBody:
        description: ""
        content:
          application/json:
            schema:
              type: object
              properties:
                auth:
                  type: object
                  description: |
                    Structure containing the site's authentication information generated according to the WSSE UsernameToken Profile 1.1"
                  properties:
                    login:
                      type: string
                      description: |
                        Site identifier
                    tranKey:
                      type: string
                      description: |
                        **tranKey** credential generated
                    nonce:
                      type: string
                      description: |
                        **Random** value for each request encoded in **Base64**.
                    seed:
                      type: string
                      description: |
                        **Current** date, generated in **ISO 8601** format.
                requestId:
                  type: string
                  description: |
                    Unique identifier of the session to be queried.
                    
                     `<= 36 characters`
                    
                     EX: `1f630ff7-9c02-4da4-82d4-d676709acb21`
              required:
                - auth
                - requestId
      responses:
        "200":
          description: "Successful query"
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Structure containing information about a request or payment, reporting its current status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status
                          
                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code
                          
                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time
                          
                           EX: `2021-09-21T09:34:48-05:00`
                    required:
                      - status
                      - reason
                      - message
                      - date
                  data:
                    type: object
                    description: Structure containing the response to the request if the status is successful
                    properties:
                      requestId:
                        type: string
                        description: |
                          Unique identifier of the session to be queried.
                          
                           EX: `1f630ff7-9c02-4da4-82d4-d676709acb21`
                      expiresAt:
                        type: string
                        description: |
                          Session expiration date
                          
                           EX: `2022-08-30 15:19:33`
                      account:
                        type: object
                        description: Information about the verified account (this field is available only if the verification was Approved and can only be viewed for the first 10 minutes)
                        properties:
                          bankName:
                            type: string
                            description: |
                              Name of the bank of the account to be processed
                              
                              `<= 30 characters`
                          bankCode:
                            type: string
                            description: |
                              Code identifying the bank in the network
                              
                              `<= 17 characters`
                          accountType:
                            type: string
                            description: |
                              Account type
                              
                              Allowed values: `SAV` `DDA`
                          accountNumber:
                            type: string
                            description: |
                              Account number
                              
                              `<= 17 characters`
                          franchise:
                            type: string
                            description: |
                              `<= 17 characters`
                          verificationCode:
                            type: string
                            description: |
                              The verificationCode is a JSON Web Signature (JWS). It is used as the instrument to verify the account status.
                              
                               EX:`eyJhbGciOiJSUzI1NiJ9.eyJhY2NvdW50SGFzaCI6ImM5YWM2ZjFhZDhjNDA3Y2ZjNzMyNDljNTE2MTJjNTdmMWQxZGNiNTA4YjE4ZGJlYWE1MWQ0NDI5NjBjMjUwNDUyMzY4ZTg2YmUzMWQ3MDMxMDY4ZDM2MjM2NzVjYzhkYTUzNzhhODNmMTUwZjg5OTczOTBiZTEyMGU1ZmExN2RhIiwib25UZXN0Ijp0cnVlLCJzZXJ2aWNlIjoibW9jayIsImlkIjo0MDB9.dFMY4EwCrWq9EBmERFkKCoLHExPH4vgaCgnZaqB_mf8n3Sv6Qnu6Pb79onluX1OZecmYmBuHqZ_ykKXWSD4RMZSpckYFCiO3mlcJKI4qb91COhl_c2qXxYJuLEdbLfGlzf0k8-oJgFcO9gAS1Xm0hpTP4iiXF6st1hFwlfR3fpX4rr-bTsKgMvRSReMuxa0Vs92DykfqUR_3udlc0DFCPB9ZTaSqeRNHFAPAWNniUPWURQlW5c9J9xcyKTgKGzfI1_7h2I4ALQeRifptE2nC-HZtEMwtcToNh7hn0oL9lNFXnXGK9sWKORcyWKVfpEChS8z30UfX6kOhU6fp_qUwmA`
        "400":
          description: |
            Invalid request.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Structure containing information about a request or payment, reporting its current status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status

                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code

                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time
                          
                           EX: `2024-09-21T09:34:48-05:00`
                required:
                  - Status
  /api/validate-existing-account:
    post:
      summary: "Validate Existing Account"
      description: "Once the initial session creation has been successfully completed, you can perform validations on the account as many times as needed. You only need the account information and the verification code provided in the previous process."
      operationId: "validate-existing-account"
      requestBody:
        description: ""
        content:
          application/json:
            schema:
              type: object
              required:
                - auth
                - user
              properties:
                auth:
                  type: object
                  description: Site authentication.
                  required:
                    - login
                    - tranKey
                    - nonce
                    - seed
                  properties:
                    login:
                      type: string
                      examples:
                        - "aabbccdd1234567890aabbccdd123456"
                    tranKey:
                      type: string
                      examples:
                        - "ABC123example456trankey+789abc012def3456ABC="
                    nonce:
                      type: string
                      examples:
                        - "enQ4dXh3YWhkMWM="
                    seed:
                      type: string
                      examples:
                        - "2023-06-21T09:56:06-05:00"
                account:
                  type: object
                  description: |
                    Account to be validated. The verification code is required.
                  required:
                    - name
                    - email
                  properties:
                    bankName:
                      type: string
                      description: |
                        Name of the bank of the account to be processed
                        
                        `<= 30 characters`
                    bankCode:
                      type: string
                      description: |
                        Code identifying the bank in the network
                        
                         `<= 17 characters`
                    accountType:
                      type: string
                      description: |
                        Account type
                        
                        Allowed values: `SAV` `DDA` `CCD`
                    accountNumber:
                      type: string
                      description: |
                        Account number
                        
                         `<= 17 characters`
                    franchise:
                      type: string
                      description: |
                        `<= 20 characters`
                    verificationCode:
                      type: string
                      description: |
                        The verificationCode is a JSON Web Signature (JWS). It is used as the instrument to verify the account status.
                        
                        EX:`eyJhbGciOiJSUzI1NiJ9.eyJhY2NvdW50SGFzaCI6ImM5YWM2ZjFhZDhjNDA3Y2ZjNzMyNDljNTE2MTJjNTdmMWQxZGNiNTA4YjE4ZGJlYWE1MWQ0NDI5NjBjMjUwNDUyMzY4ZTg2YmUzMWQ3MDMxMDY4ZDM2MjM2NzVjYzhkYTUzNzhhODNmMTUwZjg5OTczOTBiZTEyMGU1ZmExN2RhIiwib25UZXN0Ijp0cnVlLCJzZXJ2aWNlIjoibW9jayIsImlkIjo0MDB9.dFMY4EwCrWq9EBmERFkKCoLHExPH4vgaCgnZaqB_mf8n3Sv6Qnu6Pb79onluX1OZecmYmBuHqZ_ykKXWSD4RMZSpckYFCiO3mlcJKI4qb91COhl_c2qXxYJuLEdbLfGlzf0k8-oJgFcO9gAS1Xm0hpTP4iiXF6st1hFwlfR3fpX4rr-bTsKgMvRSReMuxa0Vs92DykfqUR_3udlc0DFCPB9ZTaSqeRNHFAPAWNniUPWURQlW5c9J9xcyKTgKGzfI1_7h2I4ALQeRifptE2nC-HZtEMwtcToNh7hn0oL9lNFXnXGK9sWKORcyWKVfpEChS8z30UfX6kOhU6fp_qUwmA`
                payment:
                  type: object
                  description: |
                    Structure containing information about the transaction payment.
                  required:
                    - name
                    - email
                  properties:
                    amount:
                      type: object
                      description: |
                        Structure containing information about the transaction payment.
                      properties:
                        currency:
                          type: string
                          description: |
                            `>= 3 characters` `<= 3 characters`
                            
                             EX : `USD`
                        total:
                          type: number
                locale:
                  type: string
                  description: |
                    Default: `en`
                    
                    EX: `es_CO`

      responses:
        "200":
          description: "Validation status response"
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Structure containing information about a request or payment, reporting its current status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status
                          
                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code
                          
                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time
                          
                           EX: `2021-09-21T09:34:48-05:00`
        "400":
          description: |
            Invalid request.
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Structure containing information about a request or payment, reporting its current status.
                    properties:
                      status:
                        type: string
                        description: |
                          Request status

                          Allowed values: `OK` `FAILED` `APPROVED` `APPROVED_PARTIAL` `PARTIAL_EXPIRED` `REJECTED` `PENDING` `PENDING_VALIDATION` `PENDING_PROCESS` `REFUNDED` `REVERSED` `ERROR` `UNKNOWN` `MANUAL` `DISPUTE`
                      reason:
                        type: integer
                        description: |
                          Response code

                          `>= 1 characters` `<= 4 characters`
                      message:
                        type: string
                        description: |
                          Response message
                      date:
                        type: string
                        description: |
                          Response date and time

                           EX: `2021-09-21T09:34:48-05:00`
