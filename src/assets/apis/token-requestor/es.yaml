openapi: 3.0.0
info:
  title: 'Token management and administration'
  version: 1.0.0
paths:
  /api/token/enroll:
    post:
      summary: EnrollCard
      requestBody:
        content:
          application/json:
            schema:
              type: object
              example:
                auth:
                  login: 1441d14df19ec88431e513bb990326e1
                  tranKey: DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=
                  nonce: enQ4dXh3YWhkMWM=
                  seed: 2023-06-21T09:56:06-05:00
                requestId: asdf214hs728d
                merchantId: d5502955e13a4e63aa6e12e6f1d0ab01
                instrument:
                  card:
                    number: '4123700070000045'
                    expiration: 12/23
                    cvv: '758'
                payer:
                  name: Bill
                  surname: Evans
                  email: test@visa.com
              properties:
                auth:
                  type: object
                  description: Objeto de autenticación. Ver más en **[Autentición](/token-requestor/integration/authentication)**
                  properties:
                    login:
                      type: string
                      description: 'Login para autenticación'
                    tranKey:
                      type: string
                      description: 'Clave de transacción'
                    nonce:
                      type: string
                      description: 'Valor aleatorio para evitar repeticiones'
                    seed:
                      type: string
                      description: 'Semilla de fecha y hora para la transacción'
                requestId:
                  type: string
                  description: Identificador de la solicitud enviado por el cliente para trazabilidad de errores. Ver más en **[Uso del identificador de la solicitud](/token-requestor/integration/request-id)**
                merchantId:
                  type: string
                  description: 'ID único del comercio'
                instrument:
                  type: object
                  description: 'Información del instrumento de pago'
                  properties:
                    card:
                      type: object
                      required:
                        - number
                        - expiration
                      description: 'Información de la tarjeta'
                      properties:
                        number:
                          type: string
                          description: 'Número de tarjeta'
                        expiration:
                          type: string
                          description: 'Fecha de vencimiento de la tarjeta'
                          example: 12/23
                        cvv:
                          type: string
                          description: 'Código de seguridad'
                payer:
                  type: object
                  description: 'Información del pagador'
                  properties:
                    name:
                      type: string
                      description: 'Nombre del titular de la tarjeta'
                    surname:
                      type: string
                      description: 'Apellido del titular de la tarjeta'
                    email:
                      type: string
                      description: 'Correo electrónico del titular de la tarjeta'
              required:
                - auth
                - requestId
                - merchantId
                - instrument
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    required:
                      - status
                      - reason
                      - date
                    properties:
                      status:
                        type: string
                        description: Estado de la operación
                        example: OK
                      reason:
                        type: string
                        description: Razón del estado de la operación
                        example: '00'
                      description:
                        type: string
                        description: Descripción del estado
                        example: Token created
                      date:
                        type: string
                        format: date-time
                        description: Fecha en la que se ejecutó la operación
                        example: '2025-03-17T22:45:27+00:00'
                  data:
                    type: object
                    description: Datos del resultado
                    properties:
                      requestId:
                        type: string
                        description: Identificador de la solicitud enviado por el cliente para trazabilidad de errores. Ver más en **[Uso del identificador de la solicitud](/token-requestor/integration/request-id)**
                        example: 62a89e6b-6ea9-463a-b720-4d34f76436d9
                      brandToken:
                        type: object
                        description: Datos del token
                        required:
                          - id
                          - token
                          - expiration
                          - additional
                        properties:
                          id:
                            type: string
                            description: Identificador del token para TR
                            example: rdftvuXQTZyYHaCErEcn0Q0000000000US
                          token:
                            type: string
                            description: Token usado para procesar un pago
                            example: 2222030198635406
                          expiration:
                            type: string
                            description: Fecha de expiración del token
                            example: 04/28
                          additional:
                            type: object
                            description: Información adicional del token
                            properties:
                              tokenRequestorId:
                                type: string
                                description: Identificador de TR ante las marcas
                                example: 2028-04-30
                              artUrl:
                                type: string
                                description: URL con imagen de la tarjeta
                                example: https://s3Propio.aws.com/tr/brand/1/logo.png
                              issuerName:
                                type: string
                                description: Nombre del banco emisor del token
                                example: Issuer Test
                              lastDigits:
                                type: string
                                description: Últimos 4 dígitos de la tarjeta tokenizada
                                example: '1234'
                required:
                  - status

      security:
        - Mc1eQlMX2Zg9NIsyqxuDVT7y2Ubns7hTkdsTzLZF: []
  /api/checkout:
    post:
      summary: Checkout
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - auth
                - merchantId
                - instrument
                - isRecurring
              properties:
                auth:
                  type: object
                  description: Objeto de autenticación. Ver más en **[Autentición](/token-requestor/integration/authentication)**
                  required:
                    - login
                    - tranKey
                    - nonce
                    - seed
                  properties:
                    login:
                      type: string
                      example: 1441d…
                    tranKey:
                      type: string
                      example: DGYym…
                    nonce:
                      type: string
                      example: enQ4dXh…
                    seed:
                      type: string
                      example: 2023-06…
                merchantId:
                  type: string
                  description: Identificador único del comercio
                  example: 1d6b1456-5fae-4932-92f1-5c46fe6c83e3
                instrument:
                  type: object
                  description: Objeto que tiene la información de los instrumentos de pago
                  required:
                    - brandToken
                  properties:
                    brandToken:
                      type: object
                      required:
                        - token
                      properties:
                        token:
                          type: string
                          description: Token dado en la solicitud de enrolamiento
                          example: 1b7b9879
                isRecurring:
                  type: boolean
                  description: Identifica si el criptograma será usado para recurrencia o no
                  example: false
            example:
              auth:
                login: 1441d…
                tranKey: DGYym…
                nonce: enQ4dXh…
                seed: 2023-06…
              merchantId: 1d6b1456-5fae-4932-92f1-5c46fe6c83e3
              instrument:
                brandToken:
                  token: 1b7b9879
              isRecurring: false
      description: |
        Esta API permite obtener un criptograma cifrado a partir de un token para ser usado en procesos de autorización.
        La solicitud incluye la autenticación, el identificador del comercio, el instrumento de pago y si la operación será recurrente.
      parameters:
        - name: Accept
          description: 'allowEmptyValue:false'
          in: header
          schema:
            type: string
          example: application/json
      security:
        - Mc1eQlMX2Zg9NIsyqxuDVT7y2Ubns7hTkdsTzLZF: [ ]
      responses:
        '200':
          description: OK
          content:
            application/json:
              schema:
                type: object
                required:
                  - status
                properties:
                  status:
                    type: object
                    required:
                      - status
                      - reason
                      - date
                    properties:
                      status:
                        type: string
                        description: Estado de la operación
                        example: OK
                      reason:
                        type: string
                        description: Razón del estado de la operación
                        example: "00"
                      description:
                        type: string
                        description: Descripción del estado
                        example: Operation successfull
                      date:
                        type: string
                        format: date-time
                        description: Fecha de la operación
                        example: "2025-03-17T22:45:27+00:00"
                  data:
                    type: object
                    description: Datos del resultado
                    properties:
                      cryptogram:
                        type: string
                        description: >
                          Cryptogram usado para el procesamiento o un pago, codificado en Base64.
                        example: "AIiD8382PpTdAAF3OkVCAAADFA=="
                      eci:
                        type: string
                        description: >
                          Código para indicar el nivel de seguridad y autenticación.
                        example: "05"
              examples:
                SUCCESS:
                  value:
                    status:
                      status: OK
                      reason: "00"
                      description: Operation successfull
                      date: "2025-03-17T22:45:27+00:00"
                    data:
                      cryptogram: "AIiD8382PpTdAAF3OkVCAAADFA=="
                      eci: "05"
                ERROR_INVALID_ARGUMENT:
                  value:
                    status:
                      status: FAILED
                      reason: X3
                      description: Invalid Argument
                      date: '2022-07-27T14:51:27-05:00'
                    data:
                      message: Invalid Request
                      detail: merchantInfo.argument
                ERROR_AUTH:
                  value:
                    status:
                      status: FAILED
                      reason: X3
                      description: Credentials not match
                      date: '2022-07-27T14:51:27-05:00'
                    data: [ ]
                ROUTE_NOT_FOUND:
                  value:
                    status:
                      status: FAILED
                      reason: X3
                      description: Route not found!
                      date: '2022-07-27T14:51:27-05:00'
                    data: [ ]

  /api/token/status:
    post:
      summary: GetTokenStatus
      requestBody:
        content:
          application/json:
            schema:
              type: object
              required:
                - auth
                - merchantId
                - instrument
              properties:
                auth:
                  type: object
                  description: Objeto de autenticación. Ver más en **[Autentición](/token-requestor/integration/authentication)**
                  required:
                    - login
                    - tranKey
                    - nonce
                    - seed
                  properties:
                    login:
                      type: string
                    tranKey:
                      type: string
                    nonce:
                      type: string
                    seed:
                      type: string
                merchantId:
                  type: string
                  description: Identificador único del comercio
                  format: uuid
                instrument:
                  type: object
                  description: Objeto que tiene la información de los instrumentos de pago
                  required:
                    - brandToken
                  properties:
                    brandToken:
                      type: object
                      description: Información del token
                      required:
                        - id
                      properties:
                        id:
                          type: string
                          description: Identificador del token en el aplicativo
              example:
                auth:
                  login: 1441d…
                  tranKey: DGYym…
                  nonce: enQ4dXh…
                  seed: 2023-06…
                merchantId: 1d6b1456-5fae-4932-92f1-5c46fe6c83e3
                instrument:
                  brandToken:
                    id: 1b7b9879
      parameters:
        - name: Accept
          description: 'allowEmptyValue:false'
          in: header
          schema:
            type: string
          example: application/json
      responses:
        '200':
          description: Successful response
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    required:
                      - status
                      - reason
                      - date
                    properties:
                      status:
                        type: string
                        description: Estado de la operación
                        example: OK
                      reason:
                        type: string
                        description: Razón del estado de la operación
                        example: '00'
                      description:
                        type: string
                        description: Descripción del estado
                        example: Operation successfully!
                      date:
                        type: string
                        format: date-time
                        description: Fecha en la que se ejecutó la operación
                        example: '2025-03-17T22:45:27+00:00'
                  data:
                    type: object
                    properties:
                      status:
                        type: string
                        description: Estado del token
                        enum: [ ACTIVE, INACTIVE, EXPIRED, DELETED ]
                        example: ACTIVE
                      expiration:
                        type: string
                        description: Fecha de vencimiento del token
                        example: 28/04
                      artUrl:
                        type: string
                        description: Url con imagen de la tarjeta
                        example: https://s3Propio.aws.com/tr/brand/1/logo.png
                      createdAt:
                        type: string
                        format: date
                        description: Fecha de generación del token
                        example: 2025-01-10
                      updatedAt:
                        type: string
                        format: date
                        description: Fecha de actualización del token
                        example: 2025-01-20
              examples:
                SUCCESS:
                  value:
                    status:
                      status: OK
                      reason: '00'
                      description: Operation successfully!
                      date: '2025-03-17T22:45:27+00:00'
                    data:
                      status: ACTIVE
                      expiration: 28/04
                      artUrl: https://s3Propio.aws.com/tr/brand/1/logo.png
                      createdAt: 2025-01-10
                      updatedAt: 2025-01-20
      description: 'Obtiene el estado de un token a partir del identificador proporcionado.'
      security:
        - Mc1eQlMX2Zg9NIsyqxuDVT7y2Ubns7hTkdsTzLZF: [ ]
  /api/token/delete:
    post:
      summary: Eliminar un token
      description: Este endpoint permite eliminar un token previamente registrado.
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                auth:
                  type: object
                  description: Objeto de autenticación. Ver más en la sección de Autenticación.
                  properties:
                    login:
                      type: string
                      example: "1441d…"
                    tranKey:
                      type: string
                      example: "DGYym…"
                    nonce:
                      type: string
                      example: "enQ4dXh…"
                    seed:
                      type: string
                      example: "2023-06-21T09:56:06-05:00"
                merchantId:
                  type: string
                  description: Identificador único del comercio
                  example: "1b7b8d26"
                instrument:
                  type: object
                  description: Información de los instrumentos de pago
                  properties:
                    brandToken:
                      type: object
                      description: Información del token
                      properties:
                        id:
                          type: string
                          description: Identificador único del token
                          example: "1b7b9879"
                reason:
                  type: string
                  description:
                    "Razón por la que se eliminará el token. Valores válidos: `DELETED`, `FRAUD`, `INACTIVITY`."
                  example: "FRAUD"
                description:
                  type: string
                  description: Descripción opcional de la razón
                  example: "El token se ha visto comprometido debido a una actividad fraudulenta."

              required:
                - description
                - reason
                - merchantId
                - instrument
                - auth
      responses:
        '200':
          description: Respuesta exitosa al eliminar el token
          content:
            application/json:
              schema:
                type: object
                properties:
                  status:
                    type: object
                    description: Información del estado
                    properties:
                      status:
                        type: string
                        description: Estado de la operación
                        example: "OK"
                      reason:
                        type: string
                        description: Razón del estado
                        example: "00"
                      description:
                        type: string
                        description: Descripción del estado
                        example: "successfully removed!"
                      date:
                        type: string
                        format: date-time
                        description: Fecha en que se ejecutó la operación
                        example: "2025-03-17T22:45:27+00:00"
                    required:
                      - description
                      - reason
                      - status
                      - date




