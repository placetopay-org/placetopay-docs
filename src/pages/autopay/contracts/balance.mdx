import { HeroPattern } from '@/components/HeroPattern'

<HeroPattern />

export const apiRefs = ['/autopay/balance']

## Consultar monto a cobrar {{ id: 'balance', tag: 'POST', label: '/autopay/balance' }}

Este endpoint contiene la lógica de los cobros variables (`TOTAL_BALANCE` o `MINIMUM_BALANCE`). Antes de intentar cualquier transacción, AutoPay consultará este servicio para saber **cuánto cobrar** en el instante.

### Reglas de negocio

1.  **Moneda:** La moneda (`currency`) que respondas debe coincidir con la configurada en el autopago original.
2.  **Saldo Cero:** Si respondes con un `total` de `0`, AutoPay entenderá que no hay deuda pendiente y **no realizará ningún cobro**.
3.  **Selección de Monto:** AutoPay leerá el campo correspondiente según la configuración del autopago:
    * Si es `TOTAL_BALANCE` tomará el valor de `amount`.
    * Si es `MINIMUM_BALANCE` tomará el valor de `min_amount`.

---

<Row>
    <Col>
        <ApiReader
            path="/autopay/balance"
            method="POST"
            api={props.refs}
        />
    </Col>
    <Col sticky={true}>
     <CodeGroup title="Solicitud" tag="POST" label="{{baseURl}}/autopay/balance">
 ```bash {{ title: 'Obtener balance' }}
        curl -X "POST" {{baseURl}}/autopay/balance \
        -H "Content-Type: application/json" \
        -H "Authorization: Basic <base64(username:password)>" \
        -d '{
            "reference": "ACC00012345",
            "id": "2972c13d-6315-4da3-80d7-64c24eb232ad"
        }'
  ```
        </CodeGroup>
    </Col>
</Row>

<Row>
    <Col>
        <ApiReader
            path="/autopay/balance"
            method="POST"
            type="response"
            api={props.refs}
        />
    </Col>
    <Col sticky>
        <br />
        <CodeGroup title="Respuesta">
            ```json {{ title: '200: Respuesta exitosa' }}
            {
              "status": {
                 "status": "OK",
                 "reason": "00",
                 "message": "Respuesta exitosa",
                 "date": "2025-09-29T17:09:29-05:00"
              },
              "id": "2972c13d-6315-4da3-80d7-64c24eb232ad",
              "amount": {
                 "currency": "USD",
                 "total": 10
              },
              "min_amount": {
                 "currency": "USD",
                 "total": 5
              }
            }
            ```
            ```json {{ title: '400: No encontrado' }}
            {
                "status": {
                    "status": "FAILED",
                    "reason": "404",
                    "message": "Balance no encontrado",
                    "date": "2025-09-29T17:09:29-05:00"
                }
            }
            ```
            ```json {{ title: '400: Autenticación invalida' }}
            {
                "status": {
                    "status": "FAILED",
                    "reason": "BR",
                    "message": "Autenticación no proporcionada o encabezado Authorization mal formado.",
                    "date": "2025-09-29T17:09:29-05:00"
                }
            }
            ```
            ```json {{ title: '400: Autenticación invalida - Credenciales incorrectas' }}
            {
                "status": {
                    "status": "FAILED",
                    "reason": "101",
                    "message": "Credenciales inválidas.",
                    "date": "2025-09-29T17:09:29-05:00"
                }
            }
            ```
        </CodeGroup>
    </Col>
</Row>






