export const apiRefs = ['/autopay/webhook']

## Notificaciones {{ id: 'webhook', tag: 'POST', label: '{{baseURl}}/autopay/webhook' }}
<Note type="warning">
    **baseURL**: Es la URL base del aplicativo del cliente/comercio la cual debe ser entregada por el mismo y configurada en el momento del onboarding del comercio con AutoPay.
</Note>
<Row>
    <Col>
        Debe exponer un endpoint conforme al siguiente contrato. AutoPay enviará notificaciones a dicho endpoint cada vez que un autopago sea eliminado, actualizado, se haya actualizado el medio de pago o desactivado.
        Ver [Descripción de notificaciones](/autopay/webhook-description) para más información.
        <ApiReader
            path="/autopay/webhook"
            method="POST"
            api={props.refs}
        />
    </Col>
    <Col sticky={true}>
        <CodeGroup title="Solicitud" tag="POST" label="{{baseURl}}/autopay/webhook">
            ```json {{ 'title': 'Actualización del AutoPago' }}
            {
                "auth": {
                    "login": "aabbccdd1234567890aabbccdd123456",
                    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
                    "nonce": "bmVybzNzYms4cmE=",
                    "seed": "2024-11-21T11:30:33-05:00"
                },
                "reference": "ACC00012345",
                "id": "2972c13d-6315-4da3-80d7-64c24eb232ad",
                "type": "AUTOPAY_UPDATED",
                "date": "2023-01-19 15:57:23",
            }
            ```

            ```json {{ 'title': 'Falla al cobrar un AutoPago' }}
            {
                "auth": {
                    "login": "aabbccdd1234567890aabbccdd123456",
                    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
                    "nonce": "bmVybzNzYms4cmE=",
                    "seed": "2024-11-21T11:30:33-05:00"
                },
                "reference": "ACC00012345",
                "id": "2972c13d-6315-4da3-80d7-64c24eb232ad",
                "type": "AUTOPAY_FAILED",
                "date": "2023-01-19 15:57:23",
                "data":  {
                    "transactionId": "6ea5c934-2a4d-409a-8bd6-e1568cfc771f",
                    "reason": "XA"
                }
            }
            ```

            ```json {{ 'title': 'Eliminación de AutoPago' }}
            {
                "auth": {
                    "login": "aabbccdd1234567890aabbccdd123456",
                    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
                    "nonce": "bmVybzNzYms4cmE=",
                    "seed": "2024-11-21T11:30:33-05:00"
                },
                "reference": "ACC00012345",
                "id": "2972c13d-6315-4da3-80d7-64c24eb232ad",
                "type": "AUTOPAY_CANCELED",
                "date": "2023-01-19 15:57:23",
                "data": {
                    "reason": "?F"
                }
            }
            ```
        </CodeGroup>
    </Col>
</Row>

<Row>
    <Col>
        <ApiReader
            path="/autopay/webhook"
            method="POST"
            type="response"
            api={props.refs}
        />
    </Col>
    <Col sticky>
        <br />
        <CodeGroup title="Respuesta">
            ```json {{ title: '200: Respuesta exitosa' }}
                {
                  "status": {
                     "status": "OK",
                     "reason": "00",
                     "message": "Respuesta exitosa",
                     "date": "2025-09-29T17:09:29-05:00"
                  },
                }
            ```
            ```json {{ title: '404: Factura no encontrada' }}
            {
                "status": {
                    "status": "FAILED",
                    "reason": "NF",
                    "message": "Factura no encontrada",
                    "date": "2025-09-29T17:09:29-05:00"
                },
            }
            ```
            ```json {{ title: '401: Firma inválida' }}
            {
                "status": {
                    "status": "FAILED",
                    "reason": "BR",
                    "message": "Firma inválida",
                    "date": "2025-09-29T17:09:29-05:00"
                },
            }
            ```
        </CodeGroup>
    </Col>
</Row>