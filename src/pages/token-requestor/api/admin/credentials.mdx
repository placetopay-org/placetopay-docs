export const description = 'credentials.';
import {ApiReader, CodeGroup, Col, Row} from "../../../../components/mdx";
export const sectionMode = 'nav';
export const apiRefs = [
 '/api/admin/credentials/edit',
 '/api/admin/credentials/delete',
 '/api/admin/credentials/index',
 '/api/admin/credentials/show',
 '/api/admin/credentials/create'
];


# Credenciales

La API de Credenciales Administrativas está diseñada para gestionar las credenciales utilizadas por procesadores dentro del entorno administrativo del sistema.
Estas credenciales son necesarias para interactuar con servicios protegidos, ya que incluyen valores de autenticación.

A través de esta API es posible registrar nuevas credenciales, consultarlas por login, actualizarlas con nuevos parámetros, eliminarlas cuando ya no son requeridas y listarlas aplicando filtros.
Las credenciales están asociadas al rol `PROCESSOR`

<Note> Todas las operaciones requieren autenticación por medio de credenciales válidas; se puede consultar más detalles en la sección de autenticación de esta documentación. </Note>

### Permisos disponibles

| Nombre                               | Valor                        |
|--------------------------------------|------------------------------|
| Tokenización                         | `TOKENIZATION_PROCESS`       |


### Roles por defecto del sistema

| Caso             | Rol             | Limitación                                      | Relación                                                    | Descripción                                                                                       | Permisos                 |
|------------------|------------------|------------------------------------------------|-------------------------------------------------------------|---------------------------------------------------------------------------------------------------|--------------------------|
| Comercio/Sitio   | `PROCESSOR`      | Solo operativo. No puede gestionar nada        | Especifica su consumidor y sitios (INCLUDE) para cada sitio | Solo puede generar token y criptogramas. Operativo únicamente; sin acciones de gestión.           | `TOKENIZATION_PROCESS`   |

---

## Creación de credencial {{ id: 'token-requestor-api-admin-credentials-create', tag: 'POST', label: '/api/admin/credentials/create' }}

Este endpoint permite la creación de nuevas credenciales de acceso asociadas a consumidores o sitios. Las credenciales generadas podrán ser utilizadas para acceder a servicios protegidos en función de su rol y restricciones ACL (Access Control List). Solo usuarios con permisos administrativos específicos podrán invocar esta operación.
Las credenciales pueden tener rol `PROCESSOR`, cada uno con requisitos y restricciones distintas. La creación se realiza de manera segura, asignando aleatoriamente el login y `secretKey`, además de registrar reglas ACL tipo `INCLUDE` sobre los recursos permitidos.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/create"
      method="post"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/admin/credential/create">
      ```bash {{ title: 'Crear credencial' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/credential/create \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
           "login":"1441d14df19ec88431e513bb990326e1",
           "tranKey":"DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
           "nonce":"enQ4dXh3YWhkMWM=",
           "seed":"2023-06-21T09:56:06-05:00"
        },
        "data": {
          "name": "Wallet placetopay",
          "description": "Credencial para wallet placetopay",
          "role": "PROCESSOR",
          "restrictions": {
            "sites": [
              "34227455-2fe8-4596-8999-9c249dec618a"
            ],
            "consumers": [
              "f5ff8bb0-1db9-433b-8d66-e20ebcbd12ae",
              "06a58597-c416-48d6-a7e1-f5a546b91858"
            ]
          }
        }
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/create"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
   <br />
   <CodeGroup title="Respuesta">
      ```json {{ title: 'Respuesta Exitosa' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed"
        },
        "data": {
          "login": "06c258dfab64db74352680fbdc224ffe",
          "secretKey": "ptvCmJF7KgwGmYmL",
          "restrictions": {
            "sites": [
              "34227455-2fe8-4596-8999-9c249dec618a"
            ],
            "consumers": [
              "f5ff8bb0-1db9-433b-8d66-e20ebcbd12ae",
              "06a58597-c416-48d6-a7e1-f5a546b91858"
            ]
          }
        }
      }
      ```
    </CodeGroup>
  </Col>
</Row>

---

## Consulta de credencial {{ id: 'token-requestor-api-admin-credentials-show', tag: 'POST', label: '/api/admin/credentials/show' }}

Esta operación permite consultar los detalles de una credencial previamente generada a partir de su login. Retorna todos los atributos configurados, incluyendo su rol, descripción, estado (`isEnabled`) y restricciones.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/show"
      method="post"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/admin/credential/show">
      ```bash {{ title: 'Consultar credencial por login' }}
      curl -X "POST"https://token-requestor.placetopay.ws/api/admin/credential/show \
      -H "Content-Type: application/json" \
      -d '{
         "auth": {
            "login":"1441d14df19ec88431e513bb990326e1",
            "tranKey":"DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
            "nonce":"enQ4dXh3YWhkMWM=",
            "seed":"2023-06-21T09:56:06-05:00"
        },
        "login": "06c258dfab64db74352680fbdc224ffe"
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/show"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
      ```json {{ title: 'Respuesta Exitosa' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-22T14:01:00+00:00"
        },
        "data": {
          "login": "06c258dfab64db74352680fbdc224ffe",
          "name": "Credencial PTP",
          "description": "Credencial para la wallet de placetopay",
          "role": "PROCESSOR",
          "restrictions": {
            "consumers": [
              "34227455-2fe8-4596-8999-9c249dec618a"
            ],
            "sites": []
          },
          "isEnabled": true,
          "createdAt": "2025-07-09 15:45:05",
          "updatedAt": "2025-07-09 15:45:05"
        }
      }
      ```
    </CodeGroup>
  </Col>
</Row>

---

## Actualizacion credential {{ id: 'token-requestor-api-admin-credentials-edit', tag: 'POST', label: '/api/admin/credentials/edit' }}

Permite modificar los atributos configurables de una credencial existente. Se puede cambiar el nombre, la descripción, el rol, el estado (`isEnabled`) y las restricciones de consumidores y sitios. No se puede modificar el `login` ni el `tranKey` directamente.

<Note type='warning'>
Si se envia el campo `restrictions` reemplazará las restricciones actuales de la credencial, es decir se eliminarán las restricciones existentes y creará nuevas
</Note>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/edit"
      method="post"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/admin/credentials/edit">
      ```bash {{ title: 'Editar credencial' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/credentials/edit \
      -H "Content-Type: application/json" \
      -d '{
         "auth": {
            "login":"1441d14df19ec88431e513bb990326e1",
            "tranKey":"DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
            "nonce":"enQ4dXh3YWhkMWM=",
            "seed":"2023-06-21T09:56:06-05:00"
        },
        "credential": {
          "login": "06c258dfab64db74352680fbdc224ffe",
          "name": "Credencial PTP - Actualizado",
          "email": "nuevoemail@example.com",
          "ipAddress": "10.0.0.1",
          "isEnabled": true,
          "restrictions": {
            "consumers": ["34227455-2fe8-4596-8999-9c249dec618a", "893246327-2fe8-4596-8999-9c249dec872b"],
            "sites": ["34227455-2fe8-4596-8999-9c249dec618a"]
          }
        }
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/edit"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
      ```json {{ title: 'Respuesta Exitosa' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-22T14:01:00+00:00"
        },
        "data": {
          "id": "0197efdc-aac3-7394-8f35-f0ce1e244c2c"        }
        }
      ```
    </CodeGroup>
  </Col>
</Row>

---

## Eliminacion de credencial {{ id: 'token-requestor-api-admin-credentials-delete', tag: 'POST', label: '/api/admin/credentials/delete' }}

Elimina una credencial del sistema a partir de su login. Esta operación es irreversible y requiere permisos administrativos.

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/delete"
      method="post"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/admin/credentials/delete">
      ```bash {{ title: 'Eliminar credencial' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/credentials/delete \
      -H "Content-Type: application/json" \
      -d '{
         "auth": {
            "login":"1441d14df19ec88431e513bb990326e1",
            "tranKey":"DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
            "nonce":"enQ4dXh3YWhkMWM=",
            "seed":"2023-06-21T09:56:06-05:00"
        },
        "login": "06c258dfab64db74352680fbdc224ffe"
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/delete"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
      ```json {{ title: 'Respuesta Exitosa' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-09T15:47:14+00:00"
        }
      }
      ```
    </CodeGroup>
  </Col>
</Row>

---

## Listado de credenciales {{ id: 'token-requestor-api-admin-credentials-index', tag: 'POST', label: '/api/admin/credentials/index' }}

Permite listar las credenciales registradas en el sistema con soporte de filtros y paginación. Puede filtrarse por nombre, rol, sitios, consumidores o rango de fechas de creación.


<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/index"
      method="post"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/admin/credentials/index">
      ```bash {{ title: 'Listar credenciales' }}
      curl -X "POST" https://token-requestor.placetopay.ws/api/admin/credentials/index \
      -H "Content-Type: application/json" \
      -d '{
        "auth": {
           "login":"1441d14df19ec88431e513bb990326e1",
           "tranKey":"DGYymv6ohpYwtLWon/iADE/COoo9JXt4jqyk6D006PY=",
           "nonce":"enQ4dXh3YWhkMWM=",
           "seed":"2023-06-21T09:56:06-05:00"
        },
        "filters": {
          "role": "PROCESSOR"
        },
        "pagination": {
          "perPage": 15,
          "currentPage": 1
        }
      }'
      ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/admin/credentials/index"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>

  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
      ```json {{ title: 'Respuesta Exitosa' }}
      {
        "status": {
          "status": "OK",
          "reason": "00",
          "message": "The request has been successfully processed",
          "date": "2025-07-09T15:48:00+00:00"
        },
        "data": [
          {
            "login": "06c258dfab64db74352680fbdc224ffe",
            "name": "Credencial PTP",
            "role": "PROCESSOR",
            "isEnabled": true,
            "createdAt": "2025-07-09 15:45:05",
            "updatedAt": "2025-07-09 15:46:27"
          }
        ],
        "pagination": {
          "total": 1,
          "perPage": 15,
          "currentPage": 1,
          "lastPage": 1
        },
      }
      ```
    </CodeGroup>
  </Col>
</Row>
