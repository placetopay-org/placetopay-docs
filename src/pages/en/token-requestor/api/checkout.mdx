import CheckoutSequence from "@/components/react-flow/SequenceDiagram/Diagrams/TokenRequestor/en/CheckoutSequence"

export const description = 'cryptogram.';

export const apiRefs = ['/api/tokens/cryptogram'];

# Get cryptogram

Its function is to generate a (unique) cryptogram through a brand token that will
be used to carry out a payment process. Before consuming this API, a merchant registered
with the brand and a given previous token must exist on the platform.


<CheckoutSequence />

---

## Use of the Request Identifier - _**requestId**_

If the user loses connection or is unable to retrieve the generated token,
they can call the token generation service again. This service uses the request
identifier to recover the existing token without the need to generate a new one from the brand.

However, if the endpoint is called again with the same identifier
**after 5 minutes** of generating the token, it will return an error
indicating that the identifier already exists.

---



---


## Checkout {{ id: 'checkout', tag: 'POST', label: '/api/tokens/cryptogram' }}

<Row>
  <Col>
    <ApiReader
      path="/api/tokens/cryptogram"
      method="POST"
      api={props.refs}
    />
  </Col>
  <Col sticky>

    <br />
    <CodeGroup title="Solicitud" tag="POST" label="/api/tokens/cryptogram">
    ```bash {{ title: 'cURL' }}
    curl -X "POST" https://token-requestor.placetopay.ws/api/tokens/cryptogram \
    -H "Content-Type: application/json" \
    -d '{
        "auth": {
            "login":"aabbccdd1234567890aabbccdd123456",
            "tranKey":"ABC123example456trankey+789abc012def3456ABC=",
            "nonce":"enQ4dXh3YWhkMWM=",
            "seed":"2023-06-21T09:56:06-05:00"
        },
        "siteId": "2e988305-40bb-4e77-a992-c0dce3303db9",
        "requestId": "8s992305-50cc-6io0-2903-c233osad0339",
        "instrument": {
            "brandToken": {
                "token": "5455950000007522"
            }
        },
        "isRecurring": false,
        "requestId": "972293d1-5954-46e3-b00f-153f5aea03cf"
    }
    ```
    </CodeGroup>
  </Col>
</Row>

<Row>
  <Col>
    <ApiReader
      path="/api/tokens/cryptogram"
      method="post"
      type="response"
      api={props.refs}
    />
  </Col>
  <Col sticky>
    <br />
    <CodeGroup title="Respuesta">
    ```json {{ title: '200' }}
        {
            "status": {
                "status": "OK",
                "reason": "00",
                "description": "The request has been successfully processed",
            },
            "data": {
                "cryptogram": "ahsdjhasdhjaskdABHasdjkas==",
                "eci": "06"
            }
        }
        ```
    </CodeGroup>
  </Col>
</Row>
