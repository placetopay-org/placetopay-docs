# Notifications

Token Requestor Services sends notifications whenever there is a change in
the status of tokens. Upon receiving a notification, it is recommended to
call the corresponding API to obtain more details about the change.

Before consuming this API, a merchant must be registered with the brand and a previously issued token must exist.

Each notification includes a **signature**, which must be validated by the receiver
to confirm that the notification originates from a legitimate and expected source.
This signature helps verify the authenticity of the message, ensuring it was sent by
Token Requestor Services and not by an unauthorized third party. This strengthens
the security of the process in a simple and effective way.

The signature is a cryptographic value generated from a combination of specific message
data and a secret key. Its purpose is to ensure the authenticity and integrity of the notification, confirming that:

The signature is generally generated through the following process:
- A combination of key data is taken, such as the message content and the date.
- A hash function is applied along with a secret key shared between the sender and the receiver.
- The result is a unique digital signature that the receiver can verify using the same secret key.

To validate the signature, the receiver must recalculate it using the same data and secret key.
If the result matches the received signature, the message is confirmed as legitimate and unaltered.


## Token updated

Notification related to the update of a token's status

| Field                | Type   |                                                                 | Description                                                             | Example                                    |
|----------------------|--------|-----------------------------------------------------------------|-------------------------------------------------------------------------|--------------------------------------------|
| **date**             | string | <span class=" text-teal-500 dark:text-teal-400">REQUIRED</span> | Notification date.                                                      | `2023-01-19 15:57:23`                      |
| **type**             | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Event type. Valid values: `TOKEN_UPDATED`.                              | `TOKEN_UPDATED`                            |
| **signature**        | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Cryptographic value generated from data and a secret key.               | `Base64(SHA-256(secretKey + data + date))` |
| **merchantId**       | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Merchant ID.                                                            | `2972c13d-6315-4da3-80d7-64c24eb232ad`     |
| **data**             | object | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Data related to the event.                                              | `{...}`                                    |
| **data.** id         | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Unique identifier of the token.                                         | `cc400a23227c5294cc0c1fb21a6c5a02`         |
| **data.** status     | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Token status. Valid values: `ACTIVE`, `INACTIVE`, `EXPIRED`, `DELETED`. | `ACTIVE`                                   |
| **data.** expiration | string | <span class="text-teal-500 dark:text-teal-400">REQUIRED</span>  | Expiration date of the token.                                           | `26/01`                                    |


## Sample notification sent to the subscribed user



```json
{
  "type": "TOKEN_UPDATED",
  "merchantId": "2972c13d-6315-4da3-80d7-64c24eb232ad",
  "signature": "Base64(SHA-256(secretKey + data + date))",
  "date": "2023-01-19 15:57:23",
  "data": {
    "id": "cc400a23227c5294cc0c1fb21a6c5a02",
    "status": "INACTIVE",
    "expiration": "26/01"
  }
}

```


