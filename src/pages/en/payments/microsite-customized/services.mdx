import { HeroPattern } from '@/components/HeroPattern'
import { CenteredContainer } from '@/components/CenteredContainer'

<HeroPattern />

export const description =
    'Learn how to create a Checkout session and discover the different features that Checkout offers for receiving online payments.'

# Services

All consumption is done through the base URL, which will be provided by the merchant, and the endpoint of the service to be consumed is added to said URL.
## Invoice search {{ tag: 'POST', label: '/invoice/search/' }}

**Parameters**

| Name    | Type                     |  Description                                                  |
|-----------| ------------------------ |-------------------------------------------------------- |
| `auth`        | [Authentication](/payments/microsite-customized/authentication)| Authentication information.         |
| `agreement`   | String   | Agreement code.                            |
| `searchType`  | String   | Name of the search filter, which can have one of the following values: **reference**: Searches by invoice reference. **document**: Searches by payer document number. **alt_reference**: Searches by possible alternate reference. |
| `searchValue `| String   | Search value.                            |
| `siteId`      | String        |  Site identification credential.                                                       |
| `filters (Optional)`  | [filters](/payments/microsite-customized/services#filters) | Structure that allows extending the search.                            |
| `locale `     | [Locale](/checkout/localization)     |  Indicates the platform's language. Allows for managing translations in the [Error messages.](/payments/microsite-customized/error-handling)                  |



``` json {{ 'title' : 'Example of a request'}}
 {
    "auth": {
        "login": "aabbccdd1234567890aabbccdd123456",
        "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
        "nonce": "TldFeFpqZGpPRE5rTVRNd1pUUTJPREZoTTJNeE1UYzFOekJsWVRVNFl6TT0=",
        "seed": "2025-03-06T10:43:36-05:00"
    },

    "agreement": "1234567",
    "searchType": "reference/alt_reference/document",
    "searchValue": "1040035000",
    "siteId": "657853a1y192317v2k59764fdb547e80"
 }

```

**Expected Response**

| Nombre    | Tipo                     |  Descripción                                                  |
|-----------| ------------------------ |-------------------------------------------------------- |
| `status`        | [Authentication](/payments/microsite-customized/authentication)| Describes the status of this request.         |
| `data`   | String   | Describes the status of this request.                           |
| `options`  | String   | Object containing additional options that allow modifying the payment flow behavior.  |
| `messages`| [messages](/payments/microsite-customized/services#messages)   | Object containing the messages to be displayed for each defined event. |


``` json {{ 'title' : 'Example of a response'}}

{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-11-13T11:24:27-05:00"
  },
  "data": [
    {
      "id": 4,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC",
        "name": "John",
        "surname": "Doe",
        "email": "user_email@example.com"
      },
      "payment": {
        "reference": "1234",
        "description": "Testing",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 1900,
              "base": 10000
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 130000
            }
          ],
          "currency": "COP",
          "total": 140000.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "paymentMethod": ["visa", "pse"],
      "altReference": null,
      "createdAt": "2025-10-28T00:00:00-05:00",
      "expirationDate": "2025-11-27T23:59:59-05:00"
    },
    {
      "id": 5,
      "status": "EXPIRED",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC"
      },
      "payment": {
        "reference": "1234",
        "description": "Testing",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 1900
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 130000
            }
          ],
          "currency": "COP",
          "total": 140000.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": null,
      "createdAt": "2025-09-26T00:00:00-05:00",
      "expirationDate": "2025-10-26T23:59:59-05:00"
    },
    {
      "id": 2,
      "status": "EXPIRED",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC"
      },
      "payment": {
        "reference": "1234",
        "description": "Viaje",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 12,
              "base": 90
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 108
            }
          ],
          "currency": "COP",
          "total": 120.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": "9000",
      "createdAt": "2025-04-10T00:00:00-05:00",
      "expirationDate": "2025-05-10T23:59:59-05:00"
    }
  ]
}

```

### Example of a request with the “filters” option {{id:'filters', tag:'POST', label:'/invoice/filters/'}}
This structure allows you to extend the parameters used in invoice searches. This structure does NOT replace the **“searchType/searchValue”** parameter; therefore, if a parameter has already been sent in **“searchType/searchValue”**, it should not be included in the filters structure.

| Name    | Type                     |  Description                                                  |
|-----------| ------------------------ |-------------------------------------------------------- |
| `reference (Optional)`      | String   | Invoice reference.         |
| `document (Optional)`       | String   | Invoice payer's document.|
| `alt_reference (Optional)`  | String   | Invoice alternate reference. |

**Note:** The filters sent correspond to the "Access Fields" configured on the microsite.

``` json {{ 'title' : 'Example'}}

{
  "auth": {
    "login": "aabbccdd1234567890aabbccdd123456",
    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
    "nonce": "TldFeFpqZGpPRE5rTVRNd1pUUTJPREZoTTJNeE1UYzFOekJsWVRVNFl6TT0=",
    "seed": "2025-03-06T10:43:36-05:00"
  },
  "agreement": "1234567",
  "searchType": "reference/alt_reference/document",
  "searchValue": "1040035000",
  "siteId": "657853a1y192317v2k59764fdb547e80",
  "filters": {
    "reference": "7890",
    "alt_reference": "788042"
  }
}

```

**Example of a response with no invoices found**
The **data** object must be an empty array or a null value.

``` json {{ 'title' : 'Example'}}

{
    "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-11-13T11:24:27-05:00"
 },
 "data": []
}

```

**Example response when allowing modification of the invoice amount
(includes the minAmountToPay and maxAmountToPay keys)**

``` json {{ 'title' : 'Example'}}

{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-06-22T11:24:27-05:00"
  },
  "data": [
    {
      "id": 4,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC",
        "name": "John",
        "surname": "Doe",
        "email": "user_email@example.com"
      },
      "payment": {
        "reference": "1234",
        "description": "Testing",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 1900,
              "base": 10000
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 130000
            }
          ],
          "currency": "COP",
          "total": 140000.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": null,
      "createdAt": "2025-06-10T00:00:00-05:00",
      "expirationDate": "2025-07-27T23:59:59-05:00",
      "minAmountToPay": 50000,
      "maxAmountToPay": 140000
    },
    {
      "id": 2,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC"
      },
      "payment": {
        "reference": "1234",
        "description": "Viaje",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 12,
              "base": 90
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 108
            }
          ],
          "currency": "COP",
          "total": 120.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": "9000",
      "createdAt": "2025-05-22T00:00:00-05:00",
      "expirationDate": "2025-07-22T23:59:59-05:00",
      "minAmountToPay": 40,
      "maxAmountToPay": 120
    }
  ]
}

```

**Example response when allowing modification of the maximum amount payable on invoices (includes the maxAmoutToPay key).** This scenario, where the maximum amount payable can be modified, can be seen as follows:

- Deferring the debt in installments:
    - Total Value: $ 1.200.000
    - Monthly fee: $ 100.000
    - Fees: 12
    - The debtor could decide to pay the entire debt in payment #6, in which case we would have:

``` json {{ 'title' : 'Example'}}

    {
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2021-06-22T11:24:27-05:00"
  },
  "data": [
    {
      "id": 4,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC",
        "name": "John",
        "surname": "Doe",
        "email": "user_email@example.com"
      },
      "payment": {
        "reference": "1234",
        "description": "Testing",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 0,
              "base": 0
            }
          ],
          "currency": "COP",
          "total": 1000000.0
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": null,
      "createdAt": "2025-06-10T00:00:00-05:00",
      "expirationDate": "2025-07-27T23:59:59-05:00",
      "minAmountToPay": 100000.00,
      "maxAmountToPay": 1200000.00
    }
  ]
}

```

<Note>The management of the outstanding amount to be paid must be handled by the invoice provider.</Note>

**Example response with payment methods that need to be merged for multiple payments**

``` json {{ 'title' : 'Example'}}
{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-06-22T11:24:27-05:00"
  },
  "data": [
    {
      "id": 1,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC",
        "name": "John",
        "surname": "Doe",
        "email": "user_email@example.com"
      },
      "payment": {
        "reference": "1234",
        "description": "Testing",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 1900,
              "base": 10000
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 130000
            }
          ],
          "currency": "COP",
          "total": 140000.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": null,
      "paymentMethod": ["pse", "amex"],
      "createdAt": "2025-06-10T00:00:00-05:00",
      "expirationDate": "2025-07-27T23:59:59-05:00"
    },
    {
      "id": 2,
      "status": "ACTIVE",
      "debtor": {
        "document": "1040035000",
        "documentType": "CC"
      },
      "payment": {
        "reference": "1234",
        "description": "Viaje",
        "amount": {
          "taxes": [
            {
              "kind": "valueAddedTax",
              "amount": 12,
              "base": 90
            }
          ],
          "details": [
            {
              "kind": "subtotal",
              "amount": 108
            }
          ],
          "currency": "COP",
          "total": 120.00
        },
        "allowPartial": false,
        "subscribe": false
      },
      "altReference": "9000",
      "paymentMethod": ["amex", "pse"],
      "createdAt": "2025-05-22T00:00:00-05:00",
      "expirationDate": "2025-07-22T23:59:59-05:00"
    }
  ],
  "options": {
    "mergePaymentMethods": true
  }
}


```
The parameter [mergePaymentMethods](/payments/microsite-customized/data-structures#fusion-de-metodos-de-pago-merge-payment-methods) within the ```options``` structure is what allows you to define the expected behavior in this case.


### messages {{id:'messages'}}
This structure allows you to define custom messages for data flow events, which are then displayed to the logged-in user.
These options can only be included in the query service response.

| Name                 | Type   | Description |
|------------------------|--------|-------------|
| `messages` | Object | It contains personalized messages.<br /><pre>{`{"event":{"es":"message","en":"message"}}`}</pre> |
| `messages.postSearch` | Object | Message map by language <br /><pre>{`{"es":"message","en":"message"}`}</pre> |
| `messages.postSearch.es` | String | Message corresponding to the indicated language <br /><pre>{`{"es":"message"}`}</pre> <br /> Los idiomas permitidos son <br /> - "es" (Spanish) <br /> - "en" (English) <br /> - "fr" (French) <br /> - "it" (Italian) <br /> - "pt" (Portuguese) |

**Estructura messages**

``` json {{ 'title' : 'Messages'}}

{
    "messages": {
        "postSearch": {
          "es": "Hola! tienes otras 5 órdenes de pago por pagar",
          "en": "Hi! You have others 5 bills to pay"
        }
    }
}

```


## Blocking and releasing invoices {{ tag: 'POST', label:'/invoice/hold'}}

| Name    | Type                     |  Description                                                |
|-----------| ------------------------ |--------------------------------------------------------     |
| `auth`        | [Authentication](/payments/microsite-customized/authentication)| Authentication information.         |
| `id`          | Int                      | Invoice identifier (id).                            |
| `reference`   | String                   | Invoice reference.  |
| `revoke`      | Bool                     | Determine whether the hold should be revoked or not. False: The invoice will be blocked. True: The invoice will be released..                     |
| `siteId`      | String                   | Site identification credential.                     |
| `locale `     | [Locale](/checkout/localization)     |  Indicates the platform's language. Allows for managing translations in the [Error messages.](/payments/microsite-customized/error-handling)                  |


**Example of a request to block an invoice.**
The `revoke` flag in this case should always be false.

``` json {{ 'title' : 'Example blocked invoice'}}

{
    "auth": {
    "login": "aabbccdd1234567890aabbccdd123456",
    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
    "nonce": "MTE5ODE0",
    "seed": "2025-03-20T08:53:42-05:00"
  },
    "id": 8777,
    "reference": "6313",
    "revoke": false,
    "siteId": "657853a1y192317v2k59764fdb547e80"
}

```

**Example of a blocked invoice response.**

In this case, the invoice status must be
`HOLD` so that Microsites does not allow payment of the same invoice until it is released.

``` json {{ 'title' : 'Example blocked invoice'}}
{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-03-20T10:45:33-05:00"
  },
  "data": {
    "id": 6,
    "status": "HOLD",
    "debtor": {
      "document": "1040035000",
      "documentType": "CC"
    },
    "payment": {
      "reference": "20328",
      "description": "123",
      "amount": {
        "taxes": [
          {
            "kind": "valueAddedTax",
            "amount": 1000,
            "base": 0
          }
        ],
        "details": [
          {
            "kind": "subtotal",
            "amount": 99000
          }
        ],
        "currency": "COP",
        "total": 100000.00
      },
      "allowPartial": false,
      "shipping": null,
      "items": null,
      "recurring": null,
      "subscribe": false,
      "fields": null,
      "agreement": null,
      "agreementType": null,
      "gds": null
    },
    "altReference": null,
    "createdAt": "2025-03-20",
    "expirationDate": "2025-04-19 23:59:59",
    "finalDate": "2025-04-19 23:59:59",
    "siteId": 1
  }
}


```

**Example of a request to release an invoice.**

The revoke flag in this case should always be `true`

``` json {{ 'title' : 'Example: Block invoice'}}

{
  "auth": {
  "login": "aabbccdd1234567890aabbccdd123456",
  "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
  "nonce": "MTE5ODE0",
  "seed": "2025-03-20T08:53:42-05:00"
  },
  "id": 8777,
  "reference": "6313ccx",
  "invoice": 6,
  "revoke": true,
  "siteId": "657853a1y192317v2k59764fdb547e80"
}

```

**Example of a released invoice response.**

In this case, the invoice status must be different from `HOLD`.

``` json {{ 'title' : 'Example released invoice'}}

{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-03-20T10:45:33-05:00"
  },
  "data": {
    "id": 6,
    "status": "ACTIVE",
    "debtor": {
      "document": "1040035000",
      "documentType": "CC"
    },
    "payment": {
      "reference": "20328",
      "description": "123",
      "amount": {
        "taxes": [
          {
            "kind": "valueAddedTax",
            "amount": 1000,
            "base": 0
          }
        ],
        "details": [
          {
            "kind": "subtotal",
            "amount": 99000
          }
        ],
        "currency": "COP",
        "total": 100000.00
      },
      "allowPartial": false,
      "shipping": null,
      "items": null,
      "recurring": null,
      "subscribe": false,
      "fields": null,
      "agreement": null,
      "agreementType": null,
      "gds": null
    },
    "altReference": null,
    "createdAt": "2025-03-20",
    "expirationDate": "2025-04-19 23:59:59",
    "finalDate": "2025-04-19 23:59:59",
    "siteId": 1
  }
}

```
## Mass blocking and release of invoices {{ tag: 'POST', label:'/invoice/hold-massive'}}
It is the method by which a set of invoices is blocked or released depending on the desired behavior.

| Name    | Type                     |  Description                                                |
|-----------| ------------------------ |--------------------------------------------------------     |
| `auth`        | [Authentication](/payments/microsite-customized/authentication)| Authentication information.         |
| `data`        | data(/payments/microsite-customized/services#data) | Set of invoices to block or release.                            |
| `revoke`      | Bool                     | Determine whether to revoke the hold or not. False: The invoice will be blocked. True: The invoice will be released.                     |
| `siteId`      | String                   | Site identification credential.                     |
| `locale `     | [Locale](/checkout/localization)     |  Indicates the platform's language. Allows for managing translations in the [Error messages.](/payments/microsite-customized/error-handling)                  |

### data {{ id: 'data' }}
List of invoices to block or release.
Each object represents an invoice and includes its identifier (id) and its reference (reference). Both fields are required.

| Name    | Type                     |  Description                                                  |
|-----------| ------------------------ |-------------------------------------------------------- |
| `id`        | Int                      | Invoice identifier (id).                            |
| `reference`   | String                   | Invoice reference.  |

``` json {{ 'title' : 'Example'}}

{
  "data": [
            {
              "id": 1,
              "reference": "R-0001"
            },
            {
              "id": 2,
              "reference": "R-0002"
            },
            {
              "id": 3,
              "reference": "R-0003"
            },
      ],
}

```

**Example of a request to block multiple invoices.**
The `revoke` field in this case should always be `false`.

``` json {{ 'title' : 'Example block invoice'}}

{
    "auth": {
        "login": "aabbccdd1234567890aabbccdd123456",
        "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
        "nonce": "MTE5ODE0",
        "seed": "2025-03-20T08:53:42-05:00"
      },
    "data": [
          {
            "id": 1,
            "reference": "R-0001"
          },
          {
            "id": 2,
            "reference": "R-0002"
          },
    ],
    "revoke": false,
    "siteId": "657853a1y192317v2k59764fdb547e80"
}

```

**Example of a successful response to blocked invoices.**
In this case, it is understood that all requested invoices were correctly blocked.

``` json {{ 'title' : 'Response to multiple blocked invoices'}}
{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-03-20T10:45:33-05:00"
  }
}

```

**Example of a request to release multiple invoices.**

The `revoke` field in this case must always be `true`

``` json {{ 'title' : 'Request to release multiple invoices'}}

{
  "auth": {
      "login": "aabbccdd1234567890aabbccdd123456",
      "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
      "nonce": "MTE5ODE0",
      "seed": "2025-03-20T08:53:42-05:00"
      },
  "data": [
            {
              "id": 1,
              "reference": "R-0001"
            },
            {
              "id": 2,
              "reference": "R-0002"
            },
      ],
  "invoice": 6,
  "revoke": true,
  "siteId": "657853a1y192317v2k59764fdb547e80"
}

```

**Example of a successful response to released invoices.**
In this case, it is understood that all requested invoices were released correctly.

``` json {{ 'title' : 'Response to multiple released invoices'}}
{
  "status": {
    "status": "OK",
    "reason": "00",
    "message": "The request has been processed successfully",
    "date": "2025-03-20T10:45:33-05:00"
  }
}

```

**Example of a failed response in a mass invoice blocking.**

``` json {{ 'title' : 'Failed response'}}
{
    "status": {
        "status": "FAILED",
        "reason": "99",
        "message": "There was an error processing your request",
        "date": "2019-03-20T10:45:33-05:00"
    }
}
```

## Invoice settlement {{tag:'POST', label:'/invoice/settle/'}}

| Name    | Type                     |  Description                                                |
|-----------| ------------------------ |--------------------------------------------------------     |
| `auth`        | [Authentication](/payments/microsite-customized/authentication)| Authentication information.         |
| `locale `     | [Locale](/checkout/localization)     |  Indicates the platform's language. Allows for managing translations in the [Error messages.](/payments/microsite-customized/error-handling)                  |
| `id`          | Int                      | Invoice identifier (id).                            |
| `reference`   | String                   | Referencia de la factura.  |
| `agreement`   | String   | Agreement code.                            |
| `authorization`   | String                     | Payment authorization code.                     |
| `amount`          | String                     | Amount paid.                     |
| `date`            | String                     | Payment date.                     |
| `paymentMethod`   | String                     | Payment method used.                     |
| `receipt`     | String                     | Receipt code provided by the network.                     |
| `franchise`   | String                     | Franchise code used.                     |
| `franchiseName`       | String                     | Franchise name used.                     |
| `internalReference`   | String                     | Transaction identifier in PlacetoPay.                     |
| `siteId`         | String                   |  Site identification credential.                    |
| `channel`        | String                   | Channel through which the collection was made: **OFC** = Office. **ATM** = Electronic ATM. **IVR** = Interactive Voice Response System. **DEB** = Automatic Debit. **MOV** = Mobile Banking. **WEB** = Web Portal. |
| `requestId`      | Int                   |  Web Checkout payment session identifier. This parameter allows you to check the payment status through an available method.                  |
| `issuerName`     | String                     | Name of the bank issuing the payment.                     |
| `lastDigits`     | String                     | Last 4 digits of the card used for payment.                     |
| `provider`       | String                     | The string "provider" is sent.                     |
| `method`         | String                     | Payment method code.                     |

``` json {{ 'title' : 'Example of request'}}
 {
    "auth": {
    "login": "aabbccdd1234567890aabbccdd123456",
    "tranKey": "ABC123example456trankey+789abc012def3456ABC=",
    "nonce": "MTIzNDU2Nzg=",
    "seed": "2025-03-06T10:44:49-05:00"
  },
    "id": 1,
    "reference": "12345",
    "agreement": "1234567",
    "authorization": "8785757",
    "receipt": "000000",
    "franchise": "_PSE_",
    "internalReference": 150324,
      "amount": {
      "currency": "COP",
      "total": 108900
    },
    "date": "2025-10-24T11:48:35-05:00",
    "channel": "OFC",
    "paymentMethod": "pse",
    "location": "point_1",
    "siteId": "657853a1y192317v2k59764fdb547e80",
    "requestId": 4018,
 }

```

``` json {{'title' : 'Example of response'}}
{
  "status": {
  "status": "OK",
  "reason": "00",
  "message": "The request has been processed successfully",
  "date": "2025-11-13T11:30:37-05:00"
  },
 "receipt": 1511
}
```




