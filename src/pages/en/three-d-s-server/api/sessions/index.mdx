export const apiRefs = ['/threeds/v2x/sessions']

# Service to start a session in the 3DS Server authentication flow.

The following steps will serve as a guide for using it:

**1.** Create an HTTP POST request on your server with the endpoint /sessions

**2.** In the request header, enter the bearer token, which will allow you to register as an authorized user. This header is mandatory.

**3.** The header should also contain the Content-Type value of "application/json".

**4.** Enter in the request body the minimum required fields, which are:
  - acctNumber
  - cardExpiryDate
  - purchaseAmount
  - redirectURI
  - purchaseCurrency

> The description of the request and response fields, data type, length and other specifications can be viewed in the responses section, in the data schema.

**5.** Send the request and get a response.

**6.** You can view the authentication status by redirecting to the "redirectURI", data returned in a successful response or with status "Y".

> To obtain authentication states different from "Y", you can modify the "acctNumber" field of the request with the test card numbers given in this documentation.

---
## Implementation of the v2x Contract

The implementation of a new contract is recommended, delivering the following outcomes:

| Channel | Channel Indicator | Action   | Message Category | Information                                                                                                                                      |
|---------|-------------------|----------|------------------|--------------------------------------------------------------------------------------------------------------------------------------------------|
| **APP** | "01"              | continue | PA, NPA          | This new action allows returning the transaction result and does not require user intervention to be completed.                                  |
| **BRW** | "02"              | redirect | PA, NPA          | This action is executed in BRW device flows, in which we return a `redirectURL`, to start the authentication flow.                               |
| **3RI** | "03"              | continue | PA, NPA          | This new action allows returning the transaction result and does not require user intervention to be completed.                                  |

For more details about the "redirect" action and its implementation, you can consult the specific documentation of the BRW authentication flow.

---

## Improve authentication rates with additional data
We are pleased to invite you to visit the [Additional Data](/en/three-d-s-server/api/sessions/detail-info) section in our API documentation. This section offers crucial information to optimize the 3DS authentication process.

Including this additional data in your requests allows issuers to perform a more accurate assessment, which can considerably improve successful authentication rates.

We recommend reviewing these guidelines to make the most of the API functionalities and thus offer a more secure and efficient experience to your users.

---

<Note>
For the 3RI flow, the same response contract is returned as in the Show Transaction of version 2.x.
[Values returned in the API response](/en/three-d-s-server/api/transactions/values)
</Note>

## Create a BRW or RI session {{ id: 'create-a-session', tag: 'POST', label: '/threeds/v2x/sessions' }}

<Row>
    <Col>
        This endpoint allows you to create a new session for cardholder authentication.

        <ApiReader
            path="/threeds/v2x/sessions"
            method="post"
            api={props.refs}
        />
    </Col>
    <Col sticky>
        <CodeGroup title="Request" tag="POST" label="/threeds/v2x/sessions">
            ```bash {{ title: 'BRW' }}
            curl -X "POST" https://3dss-test.placetopay.com/threeds/v2x/sessions \
            -H "Content-Type: application/json" \
            -d '{
            "acctNumber": "4005580000000040",
            "cardExpiryDate": "2506",
            "purchaseAmount": "20.5",
            "purchaseCurrency": "USD",
            "redirectURI": "https://www.placetopay.com",
            "threeDSAuthenticationInd": "PAYMENT_TRANSACTION",
            "reference": "12345"
        }'
            ```
            ```bash {{ title: 'RI' }}
            curl -X "POST" https://3dss-test.placetopay.com/threeds/v2x/sessions \
            -H "Content-Type: application/json" \
            -d '{
            "deviceChannel": "RI",
            "threeRIInd": "RECURRING_TRANSACTION",
            "threeDSRequestorPriorAuthenticationInfo": {
            "threeDSReqPriorAuthMethod": "CARDHOLDER_CHALLENGE_OCCURRED",
            "threeDSReqPriorAuthTimestamp": "2024-05-09T19:11:24+00:00",
            "threeDSReqPriorRef": "a491ce47-c8c1-4ffc-8306-0f2f7f1a143a"
        },
            "acctNumber": "4005580000000040",
            "cardExpiryDate": "2506",
            "purchaseAmount": "20.5",
            "purchaseCurrency": "USD",
            "redirectURI": "https://www.placetopay.com",
            "threeDSAuthenticationInd": "PAYMENT_TRANSACTION",
            "reference": "12345",
            "messageVersion": "2.2.0"
        }'
            ```
        </CodeGroup>
    </Col>
</Row>

<Row>
    <Col>
        <ApiReader
            path="/threeds/v2x/sessions"
            method="post"
            type="response"
            api={props.refs}
        />
    </Col>

    <Col sticky>
        <br />
        <CodeGroup title="Response">
            ```json {{ title: '200 BRW' }}
            {
                "action":"redirect",
                "sessionToken": "8e580eb1948ae1b13e614aac04c75ad31d6431ef2ea7b1a85573979b7ec4e656",
                "redirectURL": "https://3dss-test.placetopay.com/threeds/v2x/sessions/8e580eb1948ae1b13e614aac04c75ad31d6431ef2ea7b1a85573979b7ec4e656",
                "transactionID": 9099
            }
            ```
            ```json {{ title: '200 RI' }}
            {
                "action":"continue",
                "transStatus": "Y",
                "transStatusReason": null,
                "eci": "07",
                "acsTransID": "766dbd1d-9736-408c-b7c6-7a6ba352e5b2",
                "dsTransID": "cf2735c9-c4d1-4cc1-869d-6901c8f9f58f",
                "threeDSServerTransID": "c03e0003-ef69-4ee9-8938-3083ba2f2839",
                "sdkTransID": null,
                "authenticationValue": "xgSo/jtXAAAAAAAAAAAAAAAAAAA=",
                "messageVersion": "2.2.0",
                "authMethod": "FRICTIONLESS_AUTHENTICATION",
                "authTimestamp": "2024-05-09T16:06:56+00:00",
                "enrolled" : "Y",
                "messageCategory": "PA",
                "transactionID": 1318,
                "challengeInd": "NO_PREFERENCE"
            }
            ```
            ```json {{ title: '401' }}
            {
                "error_number": "1011",
                "error_description": "Invalid arguments to initiate request",
                "errors": {
                "acctNumber": [
                "The acct number field is required."
                ],
                "cardExpiryDate": [
                "The card expiry date field is required."
                ],
                "purchaseAmount": [
                "The purchase amount field is required."
                ],
                "redirectURI": [
                "The redirect URI field is required."
                ],
                "purchaseCurrency": [
                "The purchase currency field is required."
                ]
            }
            }
            ```
            ```json {{ title: '422' }}
            {
                "error_number": "1003",
                "error_description": "No se encontr√≥ un comercio asociado",
                "errors": {}
            }
            ```
        </CodeGroup>
    </Col>
</Row>
---